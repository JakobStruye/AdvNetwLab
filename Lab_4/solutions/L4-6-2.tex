Wireshark could not decrypt the earliest ping packets. It is possible that the multiple EAPOL handshakes between STA1 and AP due to the attack confused Wireshark. The others can again be decrypted with wpa-pwd aRandomPassphrase:wmn-
1-A \\ \\

After seeing the first set of ping messages (not decrypted by Wireshark), we see 128 deauthentication messages in the dump file (traces/L4-6-1.STA1.pcap).
Out of those 128 packets, 64 are sent to the STA by what appears to be AP (e.g. 203), and the other 64 are sent in the opposite direction (e.g. 205). Both of these are actually sent by the attacker, who is spoofing the source MAC address to be equal to STA1's or AP's wlan1 interface. These are the MAC addresses we added to the command. By sending deauth packets to both STA and AP, both are aware of the deauthentication, preparing both for the following reauthentication. As the purpose of a deauthentication attack is often to capture the following handshake, this is useful. By sending many deauth packets, the attacker increases the likelihood of at least one being received even when reception is poor. The attack works as soon as one is received. One pair of deauthorization packets is sent every 50ms. There is a 20ms interval between the AP to STA and the STA to AP packet. This means the attacker sends spoofed deauthorizations for about 3.15 seconds. \\ \\
%
We see the STA ceases the pings as soon as a deauthentication is received, as it thinks the AP no longer wants to receive any traffic from it. A reauthentication (packet 491) + reassociation (packet 502) start roughly 0.4 seconds after the attack ceased. Once the full authentication + assocation process is completed, pings resume at packet 522. Afterwards we started another two deauthentication attacks with the same effect.
%
