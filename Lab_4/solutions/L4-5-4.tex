We compare two encrypted Router Solicitation packets (packet 596 in \\L4-3-1.STA2.wep.pcap, packet 256 in L4-5-1.STA2.pcap). Looking at the encrypted packets, we notice that while the WEP packet has 8 bytes of WEP parameters, the WPA2 packet has 8 bytes of CCMP parameters. CCMP is the default encryption method in WPA2. This consists of an 8 byte extended IV. All 8 bytes are at the end of the 802.11 header, as opposed to the WEP parameters where 4 bytes were between the encrypted data and the FCS. We furthermore notice the encrypted data is 8 bytes larger for WPA2. After decrypting the WPA2 packets (wpa-pwd aRandomPassphrase:wmn-1-A) the 8 additional bytes are gone. We suspect these 8 bytes were a side-effect (e.g. padding) of the encryption algorithm.
